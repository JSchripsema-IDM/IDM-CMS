

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction to compartmental modeling &mdash; Compartmental Modeling (CMS)  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Compartmental Modeling (CMS)  documentation" href="index.html"/>
        <link rel="next" title="CMS installation" href="cms-installation.html"/>
        <link rel="prev" title="Compartmental Modeling Software (CMS)" href="index.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Compartmental Modeling (CMS)
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction to compartmental modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="cms-installation.html">CMS installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction-software.html">Introduction to the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto-software.html">How to use the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Compartmental Modeling (CMS)</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction to compartmental modeling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="introduction-to-compartmental-modeling">
<h1>Introduction to compartmental modeling<a class="headerlink" href="#introduction-to-compartmental-modeling" title="Permalink to this headline">¶</a></h1>
<p>Compartmental modeling is widely used among epidemiologists to simulate disease dynamics. While deterministic compartmental models (ODEs and PDEs) are fast to simulate, there are many cases where stochastic modeling (<a class="reference external" href="https://en.wikipedia.org/wiki/Master_equation">CME</a>-based methods) is preferred. Stochastic framework provides <em>distributions</em> associated with characteristics of a process and rigorous procedures for inference. In addition, deterministic models do not provide an accurate description of the system when the population in any of the compartments is low. For example, consider the following simple SIR model.</p>
<div class="math">
<p><img src="_images/math/137917b2c72f7786721f4a69b82144d262f60e47.png" alt="\begin{aligned}
S + I &amp; \stackrel{\beta}{\rightarrow} 2I,&amp;   \beta = 0.001 \\
I &amp; \stackrel{\gamma}{\rightarrow}  R, &amp;     \gamma = 0.1 \\
\end{aligned}
\\
\mathbf{x}_0 = [200 \: 1 \: 0]  \quad t_f = 150"/></p>
</div><p>In the above system, we start with 200 susceptible individuals, 1 infectious and 0 recovered. Twenty stochastic trajectories are simulated using <a class="reference internal" href="Gillespie.html"><span class="doc">Gillespie’s stochastic simulation algorithm</span></a> (SSA) <a class="footnote-reference" href="#id2" id="id1">[1]</a> and its results are compared to that of <a class="reference external" href="https://www.mathworks.com/help/matlab/ref/ode45.html">ODE45</a>.</p>
<a class="reference internal image-reference" href="_images/SIRS_ODEvSSA.jpg"><img alt="_images/SIRS_ODEvSSA.jpg" class="align-center" src="_images/SIRS_ODEvSSA.jpg" style="width: 50%;" /></a>
<p>We can see that many of the SSA trajectories show no outbreak. This is due to having only one infectious individual in the initial state. Probability of the single infectious individual recovering in the next time step is <img class="math" src="_images/math/8c5e01acbd664aa43084337abfcddde8b3f14b15.png" alt="1/3 \left(\frac{1 \times 0.1}{200 \times 1 \times 0.001+1 \times 0.1}\right)"/> while infecting one of 200 susceptible individual is <img class="math" src="_images/math/c1d142c8e99f0a0d06e068e9f55b3605161a37a6.png" alt="2/3 \left(\frac{200 \times 1 \times 0.001}{200 \times 1 \times 0.001+1 \times 0.1}\right)"/>. At the same time, we also see SSA trajectories that contain earlier and larger outbreak (population of <img class="math" src="_images/math/d2ed2630e579be280a30b6646f4d706103c337ce.png" alt="I"/>) compared to the trajectory of <img class="math" src="_images/math/d2ed2630e579be280a30b6646f4d706103c337ce.png" alt="I"/> from deterministic simulation.</p>
<p>With a large number of SSA trajectories, we can obtain an accurate distribution of states in time. For example, the distribution of recovered individuals <img class="math" src="_images/math/a00254b18ffa992f0ef19f6e6e095b83c8f85e94.png" alt="R"/> at <img class="math" src="_images/math/e0eee5786b2e9c811f38bae5f2367f0ad30bc410.png" alt="t = t_f(150)"/> using <img class="math" src="_images/math/673ace6d151bdca7a2437fa0e74c58e7ec22194f.png" alt="10^5"/> SSA trajectories looks like the following:</p>
<a class="reference internal image-reference" href="_images/SIRS_tf_distrb_R.jpg"><img alt="_images/SIRS_tf_distrb_R.jpg" class="align-center" src="_images/SIRS_tf_distrb_R.jpg" style="width: 50%;" /></a>
<p>Such distribution can be used to obtain many useful insights into the system. The first mode in the distribution (left peak) indicates that no large outbreak is observed almost half of the time by <img class="math" src="_images/math/bf7dc0b14958e6760f315c75971b40cef7e22b37.png" alt="t=150"/>. The second mode indicates the type of population immunity that may be observed at <img class="math" src="_images/math/bf7dc0b14958e6760f315c75971b40cef7e22b37.png" alt="t=150"/>. Looking at the same distribution in time can be used to study how the immunity changes over time.</p>
<p>As the size of population increases, SSA trajectories start looking more similiar to the ODE result and exhibit less variability among themselves. When we change the initial population to <img class="math" src="_images/math/24d32256f4d3128733c27559117d56c94c3754c2.png" alt="x_0 = [2000 \: 100 \: 0]"/>, we get the following result.</p>
<a class="reference internal image-reference" href="_images/SIRS_ODEvSSA_largePop.jpg"><img alt="_images/SIRS_ODEvSSA_largePop.jpg" class="align-center" src="_images/SIRS_ODEvSSA_largePop.jpg" style="width: 50%;" /></a>
<p>We note that intrinsic stochasticity may differ greatly from one model to another, depending on many factors, such as reaction rates, number of non-linear reactions, connectivity among different compartments, and population size. When a system contains compartments with a relatively large population where stochastcitity still matters, we can use an <a class="reference internal" href="Approximate Methods.html"><span class="doc">approximate method</span></a> to speed up the simulation. Several popular <a class="reference internal" href="Spatial Simulation Methods.html"><span class="doc">spatial simulation methods</span></a> are also supported in CMS, along with rare event (<a class="reference internal" href="dwSSA.html"><span class="doc">dwSSA</span></a> and <a class="reference internal" href="sdwSSA.html"><span class="doc">sdwSSA</span></a>) and <a class="reference internal" href="ExitTimes.html"><span class="doc">exit time</span></a> simulation methods.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://pubs.acs.org/doi/abs/10.1021/j100540a008?journalCode=jpchax">Gillespie, Daniel T. “Exact stochastic simulation of coupled chemical reactions.” The Journal of Physical Chemistry 81.25 (1977): 2340-361.</a></td></tr>
</tbody>
</table>
</div>


<div id="tipue_search_content"></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cms-installation.html" class="btn btn-neutral float-right" title="CMS installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Compartmental Modeling Software (CMS)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>