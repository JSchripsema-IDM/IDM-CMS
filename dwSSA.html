

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dwSSA &mdash; Compartmental Modeling (CMS)  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Compartmental Modeling (CMS)  documentation" href="index.html"/>
        <link rel="up" title="Solvers" href="solvers.html"/>
        <link rel="next" title="sdwSSA" href="sdwSSA.html"/>
        <link rel="prev" title="FractionalDiffusion" href="FractionalDiffusion.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Compartmental Modeling (CMS)
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cms-installation.html">CMS installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="introduction-software.html">Introduction to the software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="emodl.html">EMODL – model language for an input model file</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-file.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="random-number-library.html">Random number library</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="solvers.html">Solvers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Gillespie.html">Gillespie</a></li>
<li class="toctree-l3"><a class="reference internal" href="GillespieFirstReaction.html">GillespieFirstReaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="GibsonBruck.html">GibsonBruck</a></li>
<li class="toctree-l3"><a class="reference internal" href="ExitTimes.html">ExitTimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Hybrid.html">Hybrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="Midpoint.html">Midpoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="TauLeaping.html">TauLeaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="BLeaping.html">BLeaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="RLeaping.html">RLeaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="RLeapingFast.html">RLeapingFast</a></li>
<li class="toctree-l3"><a class="reference internal" href="TransportSSA.html">TransportSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="OptimalTransportSSA.html">OptimalTransportSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="DFSP.html">DFSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="FractionalDiffusion.html">FractionalDiffusion</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">dwSSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdwSSA.html">sdwSSA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output-files.html">Output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction-modeling.html">Introduction to compartmental modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto-software.html">How to use the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Compartmental Modeling (CMS)</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="introduction-software.html">Introduction to the software</a> &raquo;</li>
        
          <li><a href="solvers.html">Solvers</a> &raquo;</li>
        
      <li>dwSSA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="dwssa">
<h1>dwSSA<a class="headerlink" href="#dwssa" title="Permalink to this headline">¶</a></h1>
<p>The doubly weighted Stochastic Simulation Algorithm (dwSSA) <a class="footnote-reference" href="#id3" id="id1">[1]</a> solver is developed solely for estimating rare event probabilities and thus should not be used for recording time-course trajectories.</p>
<p>dwSSA requires a set of biasing parameters to reach the rare event of interest. If a set of biasing parameters is not provided in the .json configuration file, dwSSA will execute multilevel cross-entropy (CE) method prior to the dwSSA simulation to obtain optimal (minimum CE) biasing parameters. The solver then employs these biasing parameters in selecting the next reaction and the next time step, yielding a trajectory weight that is a product of likelihood ratios from importance sampling. For the successful trajectories that reach the rare event, these weights are used to compute an unbiased estimator of the rare event probability with a confidence interval <a class="footnote-reference" href="#id4" id="id2">[2]</a>.</p>
<p><strong>.json file template</strong></p>
<div class="highlight-JSON"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nt">&quot;runs&quot;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
    <span class="nt">&quot;solver&quot;</span><span class="p">:</span> <span class="s2">&quot;dwSSA&quot;</span><span class="p">,</span>
    <span class="nt">&quot;dwSSA&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;gamma&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.53</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">],</span>
        <span class="nt">&quot;reValName&quot;</span><span class="p">:</span> <span class="s2">&quot;reVal&quot;</span><span class="p">,</span>
        <span class="nt">&quot;reExpressionName&quot;</span><span class="p">:</span> <span class="s2">&quot;reExpression&quot;</span><span class="p">,</span>
        <span class="nt">&quot;crossEntropyRuns&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
        <span class="nt">&quot;crossEntropyThreshold&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="nt">&quot;crossEntropyMinDataSize&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
        <span class="nt">&quot;outputFileNate&quot;</span><span class="p">:</span> <span class="s2">&quot;SIR_dwSSA_1e6.txt&quot;</span>
    <span class="p">}</span>
<span class="p">}</span> 
</pre></div>
</div>
<p><strong>.json syntax for dwSSA</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">solver</span></code></dt>
<dd>takes a string as an input. <code class="code docutils literal"><span class="pre">dwSSA</span></code> is the only valid names to run this solver.</dd>
<dt><code class="docutils literal"><span class="pre">reExpressionName</span></code></dt>
<dd>takes a string as an input, which is the name of the function that defines the rare event expression in .emodl model file.  If <code class="code docutils literal"><span class="pre">reExpressionName</span></code> field is missing in the .json file, then the dwSSA solver will search .emodl file for <code class="code docutils literal"><span class="pre">reExpression</span></code> as the default name of the function.</dd>
<dt><code class="docutils literal"><span class="pre">reValName</span></code></dt>
<dd>takes a string as an input, which is the name of the parameter that defines the rare event value in .emodl model file. If <code class="code docutils literal"><span class="pre">reValName</span></code> field is missing in the .json file, then the dwSSA solver will search .emodl file for <code class="code docutils literal"><span class="pre">reVal</span></code> as the default name of the parameter.</dd>
<dt><code class="docutils literal"><span class="pre">gammas</span></code></dt>
<dd>takes a vector of positive real numbers as an input. The length of <code class="code docutils literal"><span class="pre">gammas</span></code> is equal to the total number of reactions in the model. They are used as importance sampling parameters in selecting the next reaction and the next time step, as well as in computing the likelihood ratio of a biased trajectory. If <code class="code docutils literal"><span class="pre">gammas</span></code> is missing in the .json file, multilevel cross entropy (CE) simulations are performed to compute optimal gamma values prior to dwSSA simulations.</dd>
<dt><code class="docutils literal"><span class="pre">crossEntropyRuns</span></code></dt>
<dd>takes an integer greater or equal to 5000 as an input. It defines the number of trajectories simulated in each level of multilevel CE method. This parameter is used only in multilevel CE simulations and is not required for dwSSA simulations. If <code class="code docutils literal"><span class="pre">crossEntropyRuns</span></code>  is missing in the .json file but required to run multilevel CE simulations, default value of 100,000 is used.</dd>
<dt><code class="docutils literal"><span class="pre">crossEntropyThreshold</span></code></dt>
<dd><p class="first">takes a real value in (0, 1) as an input and defines the fraction of top performing trajectories chosen to compute an intermediate rare event. It is used only in multilevel CE simulations and not required for dwSSA simulations. If <code class="code docutils literal"><span class="pre">crossEntropyThreshold</span></code> is missing in the .json file but required to run multilevel CE simulations, default value of 0.01 (1%) is used.
.. note:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">If</span> <span class="n">slow</span> <span class="n">convergence</span> <span class="ow">is</span> <span class="n">detected</span> <span class="n">during</span> <span class="n">the</span> <span class="n">multilevel</span> <span class="n">CE</span> <span class="n">simulations</span><span class="p">,</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">crossEntropyThreshold</span> <span class="ow">is</span> <span class="n">decreased</span> <span class="n">to</span> <span class="mi">80</span><span class="o">%</span> <span class="n">of</span> <span class="n">its</span> <span class="n">previous</span> <span class="n">value</span><span class="o">.</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">crossEntropyMinDataSize</span></code></dt>
<dd>takes an integer greater or equal to 100 as an input and defines the minimum number of successful trajectories required to compute an intermediate rare event. If <code class="code docutils literal"><span class="pre">crossEntropyMinDataSize</span></code> is missing in the .json file, default value of 200 is used. If <code class="code docutils literal"><span class="pre">crossEntropyRuns</span>&#160; <span class="pre">x</span>&#160; <span class="pre">crossEntropyThreshold</span></code>  is less than <code class="code docutils literal"><span class="pre">crossEntropyMinDataSize</span></code>, the multilevel CE method dynamically adjusts the value of <code class="code docutils literal"><span class="pre">crossEntropyRuns</span></code> such that <code class="code docutils literal"><span class="pre">crossEntropyRuns</span></code> is set to the smallest integer greater than <code class="code docutils literal"><span class="pre">crossEntropyMinDataSize</span></code> divided by <code class="code docutils literal"><span class="pre">crossEntropyThreshold</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">outputFileName</span></code></dt>
<dd><p class="first">takes a string as an input. If <code class="code docutils literal"><span class="pre">outputFileNate</span></code> is missing in the .json file, then a default name is used in the form of <em>modelName</em>_dwSSA_1e <code class="docutils literal"><span class="pre">log</span></code> (<code class="code docutils literal"><span class="pre">runs</span></code>), where the base of <code class="docutils literal"><span class="pre">log</span></code> is 10 and <em>modelName</em> is the name of the .emodl file.</p>
<p class="last">Recorded information includes <code class="code docutils literal"><span class="pre">runs</span></code>, estimate for the rare event probability, 68% uncertainty, and sample variance.</p>
</dd>
</dl>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://aip.scitation.org/doi/10.1063/1.3522769">Daigle, Bernie J et al. “Automated estimation of rare event probabilities in biochemical systems.” The Journal of Chemical Physics 134 4 (2011): 04410.</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://aip.scitation.org/doi/full/10.1063/1.3116791">Gillespie, Dan T et al. “Refining the weighted stochastic simulation algorithm.” The Journal of Chemical Physics 130 17 (2009): 174103.</a></td></tr>
</tbody>
</table>
</div>


<div id="tipue_search_content"></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sdwSSA.html" class="btn btn-neutral float-right" title="sdwSSA" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="FractionalDiffusion.html" class="btn btn-neutral" title="FractionalDiffusion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
<!-- Google analytics for IDM docs -->
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87656833-3', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>